// frontend/resources/js/assemblyConfigs.js

export const assemblies = {
    hg19: {
        name: 'hg19',
        contigs: [
            { name: 'chr1', length: 249250621 },
            { name: 'chr2', length: 243199373 },
            { name: 'chr3', length: 198022430 },
            { name: 'chr4', length: 191154276 },
            { name: 'chr5', length: 180915260 },
            { name: 'chr6', length: 171115067 },
            { name: 'chr7', length: 159138663 },
            { name: 'chr8', length: 146364022 },
            { name: 'chr9', length: 141213431 },
            { name: 'chr10', length: 135534747 },
            { name: 'chr11', length: 135006516 },
            { name: 'chr12', length: 133851895 },
            { name: 'chr13', length: 115169878 },
            { name: 'chr14', length: 107349540 },
            { name: 'chr15', length: 102531392 },
            { name: 'chr16', length: 90354753 },
            { name: 'chr17', length: 81195210 },
            { name: 'chr18', length: 78077248 },
            { name: 'chr19', length: 59128983 },
            { name: 'chr20', length: 63025520 },
            { name: 'chr21', length: 48129895 },
            { name: 'chr22', length: 51304566 },
            { name: 'chrX', length: 155270560 },
            { name: 'chrY', length: 59373566 }
        ]
    },
    hg38: {
        name: 'hg38',
        contigs: [
            { name: 'chr1', length: 248956422 },
            { name: 'chr2', length: 242193529 },
            { name: 'chr3', length: 198295559 },
            { name: 'chr4', length: 190214555 },
            { name: 'chr5', length: 181538259 },
            { name: 'chr6', length: 170805979 },
            { name: 'chr7', length: 159345973 },
            { name: 'chr8', length: 145138636 },
            { name: 'chr9', length: 138394717 },
            { name: 'chr10', length: 133797422 },
            { name: 'chr11', length: 135086622 },
            { name: 'chr12', length: 133275309 },
            { name: 'chr13', length: 114364328 },
            { name: 'chr14', length: 107043718 },
            { name: 'chr15', length: 101991189 },
            { name: 'chr16', length: 90338345 },
            { name: 'chr17', length: 83257441 },
            { name: 'chr18', length: 80373285 },
            { name: 'chr19', length: 58617616 },
            { name: 'chr20', length: 64444167 },
            { name: 'chr21', length: 46709983 },
            { name: 'chr22', length: 50818468 },
            { name: 'chrX', length: 156040895 },
            { name: 'chrY', length: 57227415 }
        ]
    },
    GRCh37: {
        name: 'GRCh37',
        contigs: [
            { name: '1', length: 249250621, ncbiAccession: 'NC_000001.10' },
            { name: '2', length: 243199373, ncbiAccession: 'NC_000002.11' },
            { name: '3', length: 198022430, ncbiAccession: 'NC_000003.11' },
            { name: '4', length: 191154276, ncbiAccession: 'NC_000004.11' },
            { name: '5', length: 180915260, ncbiAccession: 'NC_000005.9' },
            { name: '6', length: 171115067, ncbiAccession: 'NC_000006.11' },
            { name: '7', length: 159138663, ncbiAccession: 'NC_000007.13' },
            { name: '8', length: 146364022, ncbiAccession: 'NC_000008.10' },
            { name: '9', length: 141213431, ncbiAccession: 'NC_000009.11' },
            { name: '10', length: 135534747, ncbiAccession: 'NC_000010.10' },
            { name: '11', length: 135006516, ncbiAccession: 'NC_000011.9' },
            { name: '12', length: 133851895, ncbiAccession: 'NC_000012.11' },
            { name: '13', length: 115169878, ncbiAccession: 'NC_000013.10' },
            { name: '14', length: 107349540, ncbiAccession: 'NC_000014.8' },
            { name: '15', length: 102531392, ncbiAccession: 'NC_000015.9' },
            { name: '16', length: 90354753, ncbiAccession: 'NC_000016.9' },
            { name: '17', length: 81195210, ncbiAccession: 'NC_000017.10' },
            { name: '18', length: 78077248, ncbiAccession: 'NC_000018.9' },
            { name: '19', length: 59128983, ncbiAccession: 'NC_000019.9' },
            { name: '20', length: 63025520, ncbiAccession: 'NC_000020.10' },
            { name: '21', length: 48129895, ncbiAccession: 'NC_000021.8' },
            { name: '22', length: 51304566, ncbiAccession: 'NC_000022.10' },
            { name: 'X', length: 155270560, ncbiAccession: 'NC_000023.10' },
            { name: 'Y', length: 59373566, ncbiAccession: 'NC_000024.9' }
        ]
    },
    GRCh38: {
        name: 'GRCh38',
        contigs: [
            { name: '1', length: 248956422, ncbiAccession: 'NC_000001.11' },
            { name: '2', length: 242193529, ncbiAccession: 'NC_000002.12' },
            { name: '3', length: 198295559, ncbiAccession: 'NC_000003.12' },
            { name: '4', length: 190214555, ncbiAccession: 'NC_000004.12' },
            { name: '5', length: 181538259, ncbiAccession: 'NC_000005.10' },
            { name: '6', length: 170805979, ncbiAccession: 'NC_000006.12' },
            { name: '7', length: 159345973, ncbiAccession: 'NC_000007.14' },
            { name: '8', length: 145138636, ncbiAccession: 'NC_000008.11' },
            { name: '9', length: 138394717, ncbiAccession: 'NC_000009.12' },
            { name: '10', length: 133797422, ncbiAccession: 'NC_000010.11' },
            { name: '11', length: 135086622, ncbiAccession: 'NC_000011.10' },
            { name: '12', length: 133275309, ncbiAccession: 'NC_000012.12' },
            { name: '13', length: 114364328, ncbiAccession: 'NC_000013.11' },
            { name: '14', length: 107043718, ncbiAccession: 'NC_000014.9' },
            { name: '15', length: 101991189, ncbiAccession: 'NC_000015.10' },
            { name: '16', length: 90338345, ncbiAccession: 'NC_000016.10' },
            { name: '17', length: 83257441, ncbiAccession: 'NC_000017.11' },
            { name: '18', length: 80373285, ncbiAccession: 'NC_000018.10' },
            { name: '19', length: 58617616, ncbiAccession: 'NC_000019.10' },
            { name: '20', length: 64444167, ncbiAccession: 'NC_000020.11' },
            { name: '21', length: 46709983, ncbiAccession: 'NC_000021.9' },
            { name: '22', length: 50818468, ncbiAccession: 'NC_000022.11' },
            { name: 'X', length: 156040895, ncbiAccession: 'NC_000023.11' },
            { name: 'Y', length: 57227415, ncbiAccession: 'NC_000024.10' }
        ]
    }
};

/**
 * Get NCBI RefSeq accession for a chromosome in a given coordinate system
 * @param {string} coordinateSystem - "GRCh37" or "GRCh38"
 * @param {number|string} chromosomeNumber - Chromosome number (1-24: autosomes + X/Y, or "X"/"Y")
 * @returns {string} NCBI RefSeq accession (e.g., "NC_000001.11")
 * @throws {Error} if coordinate system is unknown or chromosome not found
 */
export function getNcbiAccession(coordinateSystem, chromosomeNumber) {
    const assembly = assemblies[coordinateSystem];
    if (!assembly) {
        throw new Error(`Unknown coordinate system: ${coordinateSystem}. Must be "GRCh37" or "GRCh38".`);
    }

    // Convert chromosome number to string name (X=23, Y=24, or use as-is)
    let chrName;
    if (chromosomeNumber === 23 || chromosomeNumber === 'X' || chromosomeNumber === 'x') {
        chrName = 'X';
    } else if (chromosomeNumber === 24 || chromosomeNumber === 'Y' || chromosomeNumber === 'y') {
        chrName = 'Y';
    } else {
        chrName = String(chromosomeNumber);
    }

    const contig = assembly.contigs.find(c => c.name === chrName);
    if (!contig || !contig.ncbiAccession) {
        throw new Error(`No NCBI accession for chromosome ${chromosomeNumber} in ${coordinateSystem}. Valid range: 1-24 (23=X, 24=Y).`);
    }

    return contig.ncbiAccession;
}
